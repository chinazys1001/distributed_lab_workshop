# Terms of Reference
## 💭 Background
Уявімо, що існує певний start-up, який має на меті створення чудо-робота. Його key feature полягає у вчасному транспортуванні сміття, яке накопичується у квартирі користувача, до вуличних контейнерів. Спрощенно кажучі, робот функціонує наступним чином: періодично перевіряє, чи заповнен смітник у квартирі користувача, якщо так - бере пакет зі сміттям та транспортує його до найближчого контейнеру у дворі та повертається назад.\
Також уявімо, що ML інженери якось магічно навчили робота знаходити смітник, відстежувати його наповненість, брати пакет зі сміттям, знаходити найближчий контейнер у дворі, транспортувати туди сміття та самостійно повертатися додому (авжеж, робот також вміє зачиняти/відкривати двері в під'їзд та квартиру користувача). Тепер постає питання, як синхронізувати користувача та робота. Вочовидь, найзручніше буде розробити мобільний додаток, запропонувати користувачеві встановити його на свій смартфон, через нього підключитися до робота й зробити всі необхідні налаштування AI ("прив'язати" робота до квартири, відсканувати ключі від дверей, тощо). Але тут виникає наступне питання: як безпечно організувати це підключення?
## ❓ До чого ж тут blockchain
В розглянутих умовах не можна дозволяти підключатися до робота по умовному Bluetooth без додаткових перевірок, як, наприклад, до TWS навушників. В цьому випадку будь-який зловмисник, який побачить робота на вулиці зможе підключитися до нього і, таким чином, фактично приватизувати робота.
Звідси отримуємо необхідність забезпечення верифікації права на володіння даним роботом при спробі підключення до нього. Якщо ми вміємо надійно перевіряти, чи є даний користувач власником роботу, то проблема є вирішеної - усі спроби несанкціонованого підключення відхиляються і робот "слухається" тільки свого власника. Таким чином, все що треба зробити - вирішити задачі по забезпеченню верифікації права власності та реалізації механізму передачі права власності. Якраз вирішення цих задач і пропонується реалізувати, використовуючи технологію блокчейн.
## 🚀 Використання технології blockchain
Для реалізації поставлених задач пропонується створити спеціальну облікову систему із використанням технології blockchain. При купівлі робота акаунту покупця видається цифрове право власності на відповідного робота і відповідна транзакція потрапляє до блокчейну. Увійшовши у мобільний застосунок зі свого акаунту, якому було видано право власності на придбаного робота, користувач зможе підключитися до нього. Зауважимо, що підключитися до робота зможе тільки той користувацький акаунт, який є власником цього робота. Для забезпечення перевірки права на власність кожен запит на підключення від користувацького застосунку буде супроводжуватися верифікаційним токеном, якій міститиме цифрову сигнатуру акаунту користувача. Користуючись даними у блокчейні робот перевірятиме цей токен і, якщо отриманий токен дійсно підтверджує право власності на даного робота, підключення буде дозволено. Підтвердивши запит на підключення, робот автоматично довіряє цьому акаунту і може ним контролюватися через застосунок. Якщо користувач захоче передати право власності на даного робота будь-якому іншому акаунту, він зможе це зручно зробити через цей застосунок, додавши відповідну транзакцію у блокчейн.
## 🎯 Технічний опис
#### Акаунт 
Враховуючи специфіку розглянутої задачі, пропонується визначити цей термін нестандартним чином. Кожен акаунт розглянутої облікової системи має рівно одну ключову пару. Публічний ключ цієї пари вважатимемо публічною адресою акаунту, яка використовується для отримання прав власності на робота; приватний ключ використовується для підтвердження права власності, тобто є залученим до генерації верифікаційного токену. Кожен акаунт має свій "баланс" - список ідентифікаційних номерів роботів, на які даний акаунт має право власності. Зрозуміло, що ці дані використовуватимуться для підтвердження права акаунту на володіння відповідними роботами.  
#### Отримання права власності
Придбаючи робота, покупець вказує свій public key (у нашому випадку <=> адресу акаунту), на який він хоче отримати право власності на робота. Після здійснення оплати, даний акаунт отримує право власності на придбаного робота і відповідна транзакція додається до блокчейну.
#### Верифікаційний токен
Для того, щоб підключатися до робота міг виключно його власник, кожен запит на підключення від користувацього застосунку до робота супроводжується верифікаційним токеном, який є цифровою сигнатурою акаунту, з якого здійснюється цей запит. Користуючись алгоритмом цифрового підпису, робот зможе провести верифікацію токену та безпечно перевірити, чи поступає запит на підключення від акаунту, який має право власності на цього робота. 
#### Алгоритм використання верифікаційного токену
1. Генеруємо токен (<=> створюємо цифровий підпис для запиту на підключення до роботу)
2. Надсилаємо токен роботу при підключенні (<=> супроводжуємо запит на підключення цифровим підписом)
3. Робот перевіряє токен. Він може це зробити, адже "знає"* public key свого власника. Користуючись стандартним механізмом цифрового підпису, робот може перевірити, чи був цей запит на підключення отриманий від акаунту-правовласника.
4. Якщо токен пройшов перевірку, робот дозволяє підключення. Інакше запит на підключення відхиляється.

*Робот "знає" public key свого правовласника, адже має доступ до блокчейну. По аналогії з [референсом](https://docs.google.com/document/d/1vXLDZnoAMnMcxI_ppxDlWeUwkrneb86b0pr_q_Kiihg/edit#heading=h.epcelfg8jt6y), в умовній robotsDatabase зберігається таблиця, в якій кожному роботу (його ідентифікатору) відповідає account id (<=> public key в нашому випадку) цого правовласника. Звідси програмне забезпечення роботу й може отримати public key акаунту-правовласника. При передачі прав власності це значення змінюється.
#### Передача права власності
Процес відбувається аналогічно отриманню права на власність. Для передачі акаунтом А права на власність аккаунту В, акаунту А необхідно і достатньо знати адресу (у нашому випадку, public key) акаунту В. Знаючи її, акаунт А може провести цю умовну транзакцію передачі цінності (у нашому випадку, права на власність) до акаунту В. Після підтвердження цієї транзакції (<=> перевірки сігнатури акаунту А та факту володіння роботом акаунтом А), право власності на робота переходить до акаунту В. Фактично, акаунти А і В укладають між собою смарт-контракт, в результаті виконання якого акаунт В стає правовласником роботу.  
## 🔨 Використовувані інструменти
Для кращої візуалізації роботи блокчейну було вирішено розробити простенький [веб-застосунок](https://baby-blockchain.web.app), користуючись Flutter SDK (мова програмування - Dart). На прикладі цього застосунку показано базовий функціонал користувацького інтерфейсу та його взаємодію з блокчейном (в якості backend-ресурсу використовується Firebase Firestore). Для зручності під цей проект створено окремий [репозиторій](https://github.com/chinazys1001/baby_blockchain). В [README](https://github.com/chinazys1001/baby_blockchain#readme) цього репозиторію будуть оновлюватися відомості щодо особливостей реалізації.